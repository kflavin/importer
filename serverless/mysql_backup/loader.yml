---
handler: lambdas/mysql_backup/backup.handler
description: MYSQL backups
environment:
  instance_type: ${file(./serverless/mysql_backup/serverless.env.yml):${self:custom.environment}.instance_type}
  backup_table_name: ${file(./serverless/mysql_backup/serverless.env.yml):${self:custom.environment}.backup_table_name}
  use_replica: ${file(./serverless/mysql_backup/serverless.env.yml):${self:custom.environment}.use_replica}
vpc:
  securityGroupIds:
    - ${file(./serverless/serverless.env.yml):${self:custom.environment}.aws_security_groups}
  subnetIds:
    - ${file(./serverless/serverless.env.yml):${self:custom.environment}.aws_lambda_subnet_1}
    - ${file(./serverless/serverless.env.yml):${self:custom.environment}.aws_lambda_subnet_2}
events:
  - schedule:
      rate: ${self:custom.schedule.mysql_backup.${self:custom.environment}.rate}
      enabled: ${self:custom.schedule.mysql_backup.${self:custom.environment}.enabled}
      name: ${self:custom.environment}-mysql_backup-loader
      description: Triggers MySQL Backups
